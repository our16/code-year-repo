# 交互式报告使用说明

## 功能概述

新增了交互式滚动报告模板,支持指标逐个滚动展示,提供更好的用户体验。

## 核心特性

### 1. 逐页滚动展示
- 每个指标占据一个完整屏幕
- 使用 scroll-snap 实现平滑滚动
- 自动对齐到最近的章节

### 2. 动画效果
- 章节淡入淡出动画
- 数字滚动计数动画
- 语言标签和项目卡片延迟动画
- 缓动函数使动画更自然

### 3. 交互功能
- **鼠标滚动**: 支持鼠标滚轮上下滚动
- **键盘导航**:
  - `↓` 或 `PageDown`: 下一页
  - `↑` 或 `PageUp`: 上一页
  - `Home`: 返回首页
  - `End`: 跳转到最后一页
- **进度指示器**: 左侧显示当前进度,点击可快速跳转

### 4. 响应式设计
- 自适应不同屏幕尺寸
- 移动端优化显示

## 使用方法

### 1. 访问交互式报告

在浏览器中访问报告URL时添加 `style=interactive` 参数:

```
http://localhost:8000/report/作者名?style=interactive
```

示例:
```
http://localhost:8000/report/Sonnet1219?style=interactive
```

### 2. 模板类型

项目现在支持三种报告模板:

| 参数值 | 模板文件 | 特点 |
|--------|---------|------|
| `default` 或不传 | `report.html` | 传统单页报告,所有内容在一个页面展示 |
| `interactive` | `report_interactive.html` | 交互式滚动报告,指标逐页展示 |
| `story` | `report_story.html` | 故事化报告,注重叙述性 |

### 3. 报告章节结构

交互式报告包含以下章节:

1. **封面** - 报告标题和年份
2. **总提交次数** - 年度提交总数
3. **净增代码行** - 创造的代码量
4. **参与项目** - 参与的项目数量
5. **代码删除** - 重构与优化
6. **AI年度总结** - AI生成的年度故事
7. **编程语言** - 技术栈分布
8. **项目详情** - 各项目的详细贡献
9. **总结** - 感谢与祝福

## 技术实现

### 核心技术

1. **Scroll Snap**
   ```css
   .main-container {
       scroll-snap-type: y mandatory;
   }
   .chapter {
       scroll-snap-align: start;
       scroll-snap-stop: always;
   }
   ```

2. **Intersection Observer**
   ```javascript
   const observer = new IntersectionObserver((entries) => {
       entries.forEach(entry => {
           if (entry.isIntersecting) {
               // 触发动画
           }
       });
   }, { threshold: 0.5 });
   ```

3. **数字动画**
   - 使用 `requestAnimationFrame` 实现平滑动画
   - 缓动函数: `easeOutQuart`
   - 格式化大数字 (1k, 1w)

### 文件结构

```
templates/
├── report.html              # 默认模板
├── report_interactive.html  # 交互式模板 (新增)
└── report_story.html        # 故事模板

src/
└── server.py                # 服务器 (已更新,支持模板选择)
```

## 自定义配置

### 修改主题颜色

报告JSON数据中的 `theme` 字段可以自定义颜色:

```json
{
  "theme": {
    "primary_color": "#667eea",
    "secondary_color": "#764ba2",
    "accent_color": "#f093fb"
  }
}
```

### 调整动画速度

在模板中修改动画持续时间:

```javascript
// 数字动画时长 (毫秒)
animateNumber(element, target, duration = 1500)

// CSS动画时长
transition: opacity 0.8s ease, transform 0.8s ease;
```

## 常见问题

### Q: 为什么我的数字没有动画效果?
A: 确保使用了 `style=interactive` 参数,并且浏览器支持 Intersection Observer API。

### Q: 如何修改报告的章节顺序?
A: 编辑 `templates/report_interactive.html` 文件,调整 `<section>` 元素的顺序。

### Q: 能否添加新的指标章节?
A: 可以,在模板中添加新的 `<section class="chapter metric-chapter">`,并在 JavaScript 中添加对应的初始化逻辑。

### Q: 移动端体验如何?
A: 模板已针对移动端优化,在移动设备上也能获得良好的体验。

## 未来改进

- [ ] 添加视频背景效果
- [ ] 支持自定义章节顺序
- [ ] 添加分享功能
- [ ] 支持导出为PDF
- [ ] 添加更多动画效果选项

## 反馈与建议

如有问题或建议,请通过以下方式联系:
- 项目Issues
- 邮件反馈

---

**最后更新**: 2025-12-28
